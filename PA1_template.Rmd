---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r}
library(knitr)
library(ggplot2)
library(dplyr)
library(plyr)
```



```{r}
temp <- tempfile()
download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip", temp, mode="wb")
unzip(temp, "activity.csv")
dataset <- read.csv("activity.csv",header=T)
unlink(temp)
```

## What is mean total number of steps taken per day?
1. Calculate the total number of steps taken per day

```{r}
totalstepsperday <- aggregate(steps ~ date, data = dataset, FUN = sum, na.rm = TRUE)
totalstepsperday
```

2. If you do not understand the difference between a histogram and a barplot, research the difference between them. Make a histogram of the total number of steps taken each day

```{r}

# converting dates to Y-M-D format
dataset$date <- as.Date(dataset$date, "%Y-%m-%d")

png("TotalStepsPlot.png",width=480,height=480)
hist(totalstepsperday$steps, 
    main="Total Steps per Day", 
    xlab="Number of Steps per Day", 
    ylab = "Interval",
    col="blue",
    breaks=60)

dev.off()
```


3. Calculate and report the mean and median of the total number of steps taken per day

## Mean
```{r}
msteps <- mean(totalstepsperday$steps)
msteps
```

## Median 
```{r}
medsteps <- median(totalstepsperday$steps)
medsteps
```

## check work using summary
```{r}
summary(totalstepsperday)
```


## What is the average daily activity pattern?

1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
```{r}
Fmins <- aggregate(steps ~ interval, data = dataset, FUN = mean, na.rm = TRUE)

png("Timeseries plot.png",width=480,height=480)
plot(x = Fmins$interval, 
    y = Fmins$steps, 
    type = "l", 
    col = "blue",
    xlab = "5-minute Timeline",
    ylab = "Average Steps Taken ~ Days",
    main = "Average Daily Activity Pattern")

dev.off()
```



## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
